(.venv) ash@Ashs-MacBook-Pro power-atlas % python examples/build_graph/simple_kg_builder_from_text.py
RUNNING FILE: /Users/ash/Documents/repos/Zoomlytics/power-atlas/examples/build_graph/simple_kg_builder_from_text.py
CWD: /Users/ash/Documents/repos/Zoomlytics/power-atlas
SCHEMA: {
  "node_types": [
    "Person",
    {
      "label": "House",
      "description": "Family the person belongs to",
      "properties": [
        {
          "name": "name",
          "type": "STRING"
        }
      ]
    },
    {
      "label": "Planet",
      "properties": [
        {
          "name": "weather",
          "type": "STRING"
        }
      ]
    }
  ],
  "relationship_types": [
    "PARENT_OF",
    {
      "label": "HEIR_OF",
      "description": "Used for inheritor relationship between father and sons"
    },
    {
      "label": "RULES",
      "properties": [
        {
          "name": "fromYear",
          "type": "INTEGER"
        }
      ]
    }
  ],
  "patterns": [
    [
      "Person",
      "PARENT_OF",
      "Person"
    ],
    [
      "Person",
      "HEIR_OF",
      "House"
    ],
    [
      "House",
      "RULES",
      "Planet"
    ]
  ]
}
INFO:neo4j_graphrag.experimental.components.schema:Converting string 'Person' to NodeType with default 'name' property and additional_properties=True to allow flexible property extraction.
DEBUG:neo4j_graphrag.experimental.pipeline.config.runner:PIPELINE_RUNNER: instantiating Pipeline from config type: PipelineType.SIMPLE_KG_PIPELINE
DEBUG:neo4j_graphrag.experimental.pipeline.config.runner:PIPELINE_CONFIG: start parsing config...
DEBUG:neo4j_graphrag.experimental.pipeline.config.pipeline_config:PIPELINE_CONFIG: resolved 'extras': {'extras': {}}
DEBUG:neo4j_graphrag.experimental.pipeline.config.pipeline_config:PIPELINE_CONFIG: resolved globals: {'extras': {}, 'neo4j_config': {'default': <neo4j._sync.driver.Neo4jDriver object at 0x1154ee010>}, 'llm_config': {'default': <neo4j_graphrag.llm.openai_llm.OpenAILLM object at 0x114a4f510>}, 'embedder_config': {'default': <neo4j_graphrag.embeddings.openai.OpenAIEmbeddings object at 0x1154edb50>}}
DEBUG:neo4j_graphrag.experimental.pipeline.config.template_pipeline.base:TEMPLATE_PIPELINE: resolved component name='splitter' component=<neo4j_graphrag.experimental.components.text_splitters.fixed_size_splitter.FixedSizeSplitter object at 0x1154ef690> run_params={}
DEBUG:neo4j_graphrag.experimental.pipeline.config.template_pipeline.base:TEMPLATE_PIPELINE: resolved component name='chunk_embedder' component=<neo4j_graphrag.experimental.components.embedder.TextChunkEmbedder object at 0x1154ed4d0> run_params={}
DEBUG:neo4j_graphrag.experimental.pipeline.config.template_pipeline.base:TEMPLATE_PIPELINE: resolved component name='schema' component=<neo4j_graphrag.experimental.components.schema.SchemaBuilder object at 0x1154ef810> run_params={'node_types': ({'label': 'Person', 'description': '', 'properties': [{'name': 'name', 'type': 'STRING', 'description': '', 'required': False}], 'additional_properties': True}, {'label': 'House', 'description': 'Family the person belongs to', 'properties': [{'name': 'name', 'type': 'STRING', 'description': '', 'required': False}], 'additional_properties': False}, {'label': 'Planet', 'description': '', 'properties': [{'name': 'weather', 'type': 'STRING', 'description': '', 'required': False}], 'additional_properties': False}), 'relationship_types': ({'label': 'PARENT_OF', 'description': '', 'properties': [], 'additional_properties': True}, {'label': 'HEIR_OF', 'description': 'Used for inheritor relationship between father and sons', 'properties': [], 'additional_properties': True}, {'label': 'RULES', 'description': '', 'properties': [{'name': 'fromYear', 'type': 'INTEGER', 'description': '', 'required': False}], 'additional_properties': False}), 'patterns': ({'source': 'Person', 'relationship': 'PARENT_OF', 'target': 'Person'}, {'source': 'Person', 'relationship': 'HEIR_OF', 'target': 'House'}, {'source': 'House', 'relationship': 'RULES', 'target': 'Planet'}), 'constraints': (), 'additional_node_types': False, 'additional_relationship_types': False, 'additional_patterns': False}
DEBUG:neo4j_graphrag.experimental.pipeline.config.template_pipeline.base:TEMPLATE_PIPELINE: resolved component name='extractor' component=<neo4j_graphrag.experimental.components.entity_relation_extractor.LLMEntityRelationExtractor object at 0x1154efd10> run_params={}
DEBUG:neo4j_graphrag.experimental.pipeline.config.template_pipeline.base:TEMPLATE_PIPELINE: resolved component name='pruner' component=<neo4j_graphrag.experimental.components.graph_pruning.GraphPruning object at 0x1154efe10> run_params={}
DEBUG:neo4j_graphrag.experimental.pipeline.config.template_pipeline.base:TEMPLATE_PIPELINE: resolved component name='writer' component=<neo4j_graphrag.experimental.components.kg_writer.Neo4jWriter object at 0x1154efe50> run_params={}
DEBUG:neo4j_graphrag.experimental.pipeline.config.template_pipeline.base:TEMPLATE_PIPELINE: resolved component name='resolver' component=<neo4j_graphrag.experimental.components.resolver.SinglePropertyExactMatchResolver object at 0x11550e210> run_params={}
INFO:neo4j_graphrag.experimental.pipeline.config.runner:PIPELINE_RUNNER: starting pipeline <neo4j_graphrag.experimental.pipeline.pipeline.Pipeline object at 0x1154fc310> with run_params={'schema': {'node_types': ({'label': 'Person', 'description': '', 'properties': [{'name': 'name', 'type': 'STRING', 'description': '', 'required': False}], 'additional_properties': True}, {'label': 'House', 'description': 'Family the person belongs to', 'properties': [{'name': 'name', 'type': 'STRING', 'description': '', 'required': False}], 'additional_properties': False}, {'label': 'Planet', 'description': '', 'properties': [{'name': 'weather', 'type': 'STRING', 'description': '', 'required': False}], 'additional_properties': False}), 'relationship_types': ({'label': 'PARENT_OF', 'description': '', 'properties': [], 'additional_properties': True}, {'label': 'HEIR_OF', 'description': 'Used for inheritor relationship between father and sons', 'properties': [], 'additional_properties': True}, {'label': 'RULES', 'description': '', 'properties': [{'name': 'fromYear', 'type': 'INTEGER', 'description': '', 'required': False}], 'additional_properties': False}), 'patterns': ({'source': 'Person', 'relationship': 'PARENT_OF', 'target': 'Person'}, {'source': 'Person', 'relationship': 'HEIR_OF', 'target': 'House'}, {'source': 'House', 'relationship': 'RULES', 'target': 'Planet'}), 'constraints': (), 'additional_node_types': False, 'additional_relationship_types': False, 'additional_patterns': False}, 'splitter': {'text': 'The son of Duke Leto Atreides and the Lady Jessica, Paul is the heir of House Atreides,\nan aristocratic family that rules the planet Caladan, the rainy planet, since 10191.'}, 'extractor': {'document_info': {'path': 'document.txt', 'metadata': None, 'document_type': 'inline_text'}}}
DEBUG:neo4j_graphrag.experimental.pipeline.pipeline:PIPELINE START with run_id='302de781-ad0d-4f09-bfea-165982c135d9'
DEBUG:neo4j_graphrag.experimental.pipeline.pipeline:TASK START self.name='splitter' input={'text': 'The son of Duke Leto Atreides and the Lady Jessica, Paul is the heir of House Atreides,\nan aristocratic family that rules the planet Caladan, the rainy planet, since 10191.'}
DEBUG:neo4j_graphrag.experimental.pipeline.pipeline:TASK FINISHED splitter in 0.0s res={'status': <RunStatus.DONE: 'DONE'>, 'result': {'chunks': [{'text': 'The son of Duke Leto Atreides and the Lady Jessica, Paul is the heir of House Atreides,\nan aristocratic family that rules the planet Caladan, the rainy planet, since 10191.', 'index': 0, 'metadata': None, 'uid': '3c02cebf-e283-4276-b4d3-5679619eb4c8'}]}, 'timestamp': datetime.datetime(2026, 2, 25, 4, 13, 25, 411577, tzinfo=datetime.timezone.utc)}
DEBUG:neo4j_graphrag.experimental.pipeline.orchestrator:ORCHESTRATOR 302de781-ad0d-4f09-bfea-165982c135d9: enqueuing next task: chunk_embedder
DEBUG:neo4j_graphrag.experimental.pipeline.pipeline:TASK START self.name='schema' input={'node_types': ({'label': 'Person', 'description': '', 'properties': [{'name': 'name', 'type': 'STRING', 'description': '', 'required': False}], 'additional_properties': True}, {'label': 'House', 'description': 'Family the person belongs to', 'properties': [{'name': 'name', 'type': 'STRING', 'description': '', 'required': False}], 'additional_properties': False}, {'label': 'Planet', 'description': '', 'properties': [{'name': 'weather', 'type': 'STRING', 'description': '', 'required': False}], 'additional_properties': False}), 'relationship_types': ({'label': 'PARENT_OF', 'description': '', 'properties': [], 'additional_properties': True}, {'label': 'HEIR_OF', 'description': 'Used for inheritor relationship between father and sons', 'properties': [], 'additional_properties': True}, {'label': 'RULES', 'description': '', 'properties': [{'name': 'fromYear', 'type': 'INTEGER', 'description': '', 'required': False}], 'additional_properties': False}), 'patterns': ({'source': 'Person', 'relationship': 'PARENT_OF', 'target': 'Person'}, {'source': 'Person', 'relationship': 'HEIR_OF', 'target': 'House'}, {'source': 'House', 'relationship': 'RULES', 'target': 'Planet'}), 'constraints': (), 'additional_node_types': False, 'additional_relationship_types': False, 'additional_patterns': False}
DEBUG:neo4j_graphrag.experimental.pipeline.pipeline:TASK FINISHED schema in 0.0s res={'status': <RunStatus.DONE: 'DONE'>, 'result': {'node_types': ({'label': 'Person', 'description': '', 'properties': [{'name': 'name', 'type': 'STRING', 'description': '', 'required': False}], 'additional_properties': True}, {'label': 'House', 'description': 'Family the person belongs to', 'properties': [{'name': 'name', 'type': 'STRING', 'description': '', 'required': False}], 'additional_properties': False}, {'label': 'Planet', 'description': '', 'properties': [{'name': 'weather', 'type': 'STRING', 'description': '', 'required': False}], 'additional_properties': False}), 'relationship_types': ({'label': 'PARENT_OF', 'description': '', 'properties': [], 'additional_properties': True}, {'label': 'HEIR_OF', 'description': 'Used for inheritor relationship between father and sons', 'properties': [], 'additional_properties': True}, {'label': 'RULES', 'description': '', 'properties': [{'name': 'fromYear', 'type': 'INTEGER', 'description': '', 'required': False}], 'additional_properties': False}), 'patterns': ({'source': 'Person', 'relationship': 'PARENT_OF', 'target': 'Person'}, {'source': 'Person', 'relationship': 'HEIR_OF', 'target': 'House'}, {'source': 'House', 'relationship': 'RULES', 'target': 'Planet'}), 'constraints': (), 'additional_node_types': False, 'additional_relationship_types': False, 'additional_patterns': False}, 'timestamp': datetime.datetime(2026, 2, 25, 4, 13, 25, 412192, tzinfo=datetime.timezone.utc)}
DEBUG:neo4j_graphrag.experimental.pipeline.orchestrator:ORCHESTRATOR 302de781-ad0d-4f09-bfea-165982c135d9: TASK DELAYED: Missing dependency chunk_embedder for extractor (status: RunStatus.UNKNOWN). Will try again when dependency is complete.
DEBUG:neo4j_graphrag.experimental.pipeline.pipeline:TASK START self.name='chunk_embedder' input={'text_chunks': {'chunks': [{'text': 'The son of Duke Leto Atreides and the Lady Jessica, Paul is the heir of House Atreides,\nan aristocratic family that rules the planet Caladan, the rainy planet, since 10191.', 'index': 0, 'metadata': None, 'uid': '3c02cebf-e283-4276-b4d3-5679619eb4c8'}]}}
DEBUG:neo4j_graphrag.experimental.pipeline.pipeline:TASK FINISHED chunk_embedder in 1.46s res={'status': <RunStatus.DONE: 'DONE'>, 'result': {'chunks': [{'text': 'The son of Duke Leto Atreides and the Lady Jessica, Paul is the heir of House Atreides,\nan aristocratic family that rules the planet Caladan, the rainy planet, since 10191.', 'index': 0, 'metadata': {'embedding': [0.005049355793744326, -0.005022849887609482, -0.024464856833219528, -0.023815464228391647, -0.008548121899366379, '... (1531 items)']}, 'uid': '3c02cebf-e283-4276-b4d3-5679619eb4c8'}]}, 'timestamp': datetime.datetime(2026, 2, 25, 4, 13, 26, 870825, tzinfo=datetime.timezone.utc)}
DEBUG:neo4j_graphrag.experimental.pipeline.orchestrator:ORCHESTRATOR 302de781-ad0d-4f09-bfea-165982c135d9: enqueuing next task: extractor
DEBUG:neo4j_graphrag.experimental.pipeline.pipeline:TASK START self.name='extractor' input={'document_info': {'path': 'document.txt', 'metadata': None, 'document_type': 'inline_text'}, 'schema': {'node_types': ({'label': 'Person', 'description': '', 'properties': [{'name': 'name', 'type': 'STRING', 'description': '', 'required': False}], 'additional_properties': True}, {'label': 'House', 'description': 'Family the person belongs to', 'properties': [{'name': 'name', 'type': 'STRING', 'description': '', 'required': False}], 'additional_properties': False}, {'label': 'Planet', 'description': '', 'properties': [{'name': 'weather', 'type': 'STRING', 'description': '', 'required': False}], 'additional_properties': False}), 'relationship_types': ({'label': 'PARENT_OF', 'description': '', 'properties': [], 'additional_properties': True}, {'label': 'HEIR_OF', 'description': 'Used for inheritor relationship between father and sons', 'properties': [], 'additional_properties': True}, {'label': 'RULES', 'description': '', 'properties': [{'name': 'fromYear', 'type': 'INTEGER', 'description': '', 'required': False}], 'additional_properties': False}), 'patterns': ({'source': 'Person', 'relationship': 'PARENT_OF', 'target': 'Person'}, {'source': 'Person', 'relationship': 'HEIR_OF', 'target': 'House'}, {'source': 'House', 'relationship': 'RULES', 'target': 'Planet'}), 'constraints': (), 'additional_node_types': False, 'additional_relationship_types': False, 'additional_patterns': False}, 'chunks': {'chunks': [{'text': 'The son of Duke Leto Atreides and the Lady Jessica, Paul is the heir of House Atreides,\nan aristocratic family that rules the planet Caladan, the rainy planet, since 10191.', 'index': 0, 'metadata': {'embedding': [0.005049355793744326, -0.005022849887609482, -0.024464856833219528, -0.023815464228391647, -0.008548121899366379, '... (1531 items)']}, 'uid': '3c02cebf-e283-4276-b4d3-5679619eb4c8'}]}}
DEBUG:neo4j_graphrag.experimental.components.entity_relation_extractor:Extracted graph: {'nodes': [{'id': 'e2c5b257-adf4-49df-a684-f3e84dff21ed', 'label': 'Document', 'properties': {'path': 'document.txt', 'createdAt': '2026-02-25T04:13:26.872268+00:00', 'document_type': 'inline_text'}, 'embedding_properties': {}}, {'id': '3c02cebf-e283-4276-b4d3-5679619eb4c8', 'label': 'Chunk', 'properties': {'text': 'The son of Duke Leto Atreides and the Lady Jessica, Paul is the heir of House Atreides,\nan aristocratic family that rules the planet Caladan, the rainy planet, since 10191.', 'index': 0}, 'embedding_properties': {'embedding': [0.005049355793744326, -0.005022849887609482, -0.024464856833219528, -0.023815464228391647, -0.008548121899366379, '... (1531 items)']}}, {'id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:0', 'label': 'Person', 'properties': {'name': 'Paul'}, 'embedding_properties': {}}, {'id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:1', 'label': 'House', 'properties': {'name': 'House Atreides'}, 'embedding_properties': {}}, {'id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:2', 'label': 'Planet', 'properties': {'weather': 'rainy'}, 'embedding_properties': {}}], 'relationships': [{'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8', 'end_node_id': 'e2c5b257-adf4-49df-a684-f3e84dff21ed', 'type': 'FROM_DOCUMENT', 'properties': {}, 'embedding_properties': {}}, {'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:0', 'end_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:1', 'type': 'HEIR_OF', 'properties': {}, 'embedding_properties': {}}, {'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:1', 'end_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:2', 'type': 'RULES', 'properties': {'fromYear': 10191}, 'embedding_properties': {}}, {'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:0', 'end_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8', 'type': 'FROM_CHUNK', 'properties': {}, 'embedding_properties': {}}, {'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:1', 'end_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8', 'type': 'FROM_CHUNK', 'properties': {}, 'embedding_properties': {}}, '... (1 items)']}
DEBUG:neo4j_graphrag.experimental.pipeline.pipeline:TASK FINISHED extractor in 3.24s res={'status': <RunStatus.DONE: 'DONE'>, 'result': {'nodes': [{'id': 'e2c5b257-adf4-49df-a684-f3e84dff21ed', 'label': 'Document', 'properties': {'path': 'document.txt', 'createdAt': '2026-02-25T04:13:26.872268+00:00', 'document_type': 'inline_text'}, 'embedding_properties': {}}, {'id': '3c02cebf-e283-4276-b4d3-5679619eb4c8', 'label': 'Chunk', 'properties': {'text': 'The son of Duke Leto Atreides and the Lady Jessica, Paul is the heir of House Atreides,\nan aristocratic family that rules the planet Caladan, the rainy planet, since 10191.', 'index': 0}, 'embedding_properties': {'embedding': [0.005049355793744326, -0.005022849887609482, -0.024464856833219528, -0.023815464228391647, -0.008548121899366379, '... (1531 items)']}}, {'id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:0', 'label': 'Person', 'properties': {'name': 'Paul'}, 'embedding_properties': {}}, {'id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:1', 'label': 'House', 'properties': {'name': 'House Atreides'}, 'embedding_properties': {}}, {'id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:2', 'label': 'Planet', 'properties': {'weather': 'rainy'}, 'embedding_properties': {}}], 'relationships': [{'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8', 'end_node_id': 'e2c5b257-adf4-49df-a684-f3e84dff21ed', 'type': 'FROM_DOCUMENT', 'properties': {}, 'embedding_properties': {}}, {'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:0', 'end_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:1', 'type': 'HEIR_OF', 'properties': {}, 'embedding_properties': {}}, {'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:1', 'end_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:2', 'type': 'RULES', 'properties': {'fromYear': 10191}, 'embedding_properties': {}}, {'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:0', 'end_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8', 'type': 'FROM_CHUNK', 'properties': {}, 'embedding_properties': {}}, {'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:1', 'end_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8', 'type': 'FROM_CHUNK', 'properties': {}, 'embedding_properties': {}}, '... (1 items)']}, 'timestamp': datetime.datetime(2026, 2, 25, 4, 13, 30, 115595, tzinfo=datetime.timezone.utc)}
DEBUG:neo4j_graphrag.experimental.pipeline.orchestrator:ORCHESTRATOR 302de781-ad0d-4f09-bfea-165982c135d9: enqueuing next task: pruner
DEBUG:neo4j_graphrag.experimental.pipeline.pipeline:TASK START self.name='pruner' input={'graph': {'nodes': [{'id': 'e2c5b257-adf4-49df-a684-f3e84dff21ed', 'label': 'Document', 'properties': {'path': 'document.txt', 'createdAt': '2026-02-25T04:13:26.872268+00:00', 'document_type': 'inline_text'}, 'embedding_properties': {}}, {'id': '3c02cebf-e283-4276-b4d3-5679619eb4c8', 'label': 'Chunk', 'properties': {'text': 'The son of Duke Leto Atreides and the Lady Jessica, Paul is the heir of House Atreides,\nan aristocratic family that rules the planet Caladan, the rainy planet, since 10191.', 'index': 0}, 'embedding_properties': {'embedding': [0.005049355793744326, -0.005022849887609482, -0.024464856833219528, -0.023815464228391647, -0.008548121899366379, '... (1531 items)']}}, {'id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:0', 'label': 'Person', 'properties': {'name': 'Paul'}, 'embedding_properties': {}}, {'id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:1', 'label': 'House', 'properties': {'name': 'House Atreides'}, 'embedding_properties': {}}, {'id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:2', 'label': 'Planet', 'properties': {'weather': 'rainy'}, 'embedding_properties': {}}], 'relationships': [{'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8', 'end_node_id': 'e2c5b257-adf4-49df-a684-f3e84dff21ed', 'type': 'FROM_DOCUMENT', 'properties': {}, 'embedding_properties': {}}, {'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:0', 'end_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:1', 'type': 'HEIR_OF', 'properties': {}, 'embedding_properties': {}}, {'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:1', 'end_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:2', 'type': 'RULES', 'properties': {'fromYear': 10191}, 'embedding_properties': {}}, {'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:0', 'end_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8', 'type': 'FROM_CHUNK', 'properties': {}, 'embedding_properties': {}}, {'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:1', 'end_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8', 'type': 'FROM_CHUNK', 'properties': {}, 'embedding_properties': {}}, '... (1 items)']}, 'schema': {'node_types': ({'label': 'Person', 'description': '', 'properties': [{'name': 'name', 'type': 'STRING', 'description': '', 'required': False}], 'additional_properties': True}, {'label': 'House', 'description': 'Family the person belongs to', 'properties': [{'name': 'name', 'type': 'STRING', 'description': '', 'required': False}], 'additional_properties': False}, {'label': 'Planet', 'description': '', 'properties': [{'name': 'weather', 'type': 'STRING', 'description': '', 'required': False}], 'additional_properties': False}), 'relationship_types': ({'label': 'PARENT_OF', 'description': '', 'properties': [], 'additional_properties': True}, {'label': 'HEIR_OF', 'description': 'Used for inheritor relationship between father and sons', 'properties': [], 'additional_properties': True}, {'label': 'RULES', 'description': '', 'properties': [{'name': 'fromYear', 'type': 'INTEGER', 'description': '', 'required': False}], 'additional_properties': False}), 'patterns': [{'source': 'Person', 'relationship': 'PARENT_OF', 'target': 'Person'}, {'source': 'Person', 'relationship': 'HEIR_OF', 'target': 'House'}, {'source': 'House', 'relationship': 'RULES', 'target': 'Planet'}], 'constraints': (), 'additional_node_types': False, 'additional_relationship_types': False, 'additional_patterns': False}}
DEBUG:neo4j_graphrag.experimental.pipeline.pipeline:TASK FINISHED pruner in 0.0s res={'status': <RunStatus.DONE: 'DONE'>, 'result': {'graph': {'nodes': [{'id': 'e2c5b257-adf4-49df-a684-f3e84dff21ed', 'label': 'Document', 'properties': {'path': 'document.txt', 'createdAt': '2026-02-25T04:13:26.872268+00:00', 'document_type': 'inline_text'}, 'embedding_properties': {}}, {'id': '3c02cebf-e283-4276-b4d3-5679619eb4c8', 'label': 'Chunk', 'properties': {'text': 'The son of Duke Leto Atreides and the Lady Jessica, Paul is the heir of House Atreides,\nan aristocratic family that rules the planet Caladan, the rainy planet, since 10191.', 'index': 0}, 'embedding_properties': {'embedding': [0.005049355793744326, -0.005022849887609482, -0.024464856833219528, -0.023815464228391647, -0.008548121899366379, '... (1531 items)']}}, {'id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:0', 'label': 'Person', 'properties': {'name': 'Paul'}, 'embedding_properties': {}}, {'id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:1', 'label': 'House', 'properties': {'name': 'House Atreides'}, 'embedding_properties': {}}, {'id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:2', 'label': 'Planet', 'properties': {'weather': 'rainy'}, 'embedding_properties': {}}], 'relationships': [{'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8', 'end_node_id': 'e2c5b257-adf4-49df-a684-f3e84dff21ed', 'type': 'FROM_DOCUMENT', 'properties': {}, 'embedding_properties': {}}, {'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:0', 'end_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:1', 'type': 'HEIR_OF', 'properties': {}, 'embedding_properties': {}}, {'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:1', 'end_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:2', 'type': 'RULES', 'properties': {'fromYear': 10191}, 'embedding_properties': {}}, {'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:0', 'end_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8', 'type': 'FROM_CHUNK', 'properties': {}, 'embedding_properties': {}}, {'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:1', 'end_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8', 'type': 'FROM_CHUNK', 'properties': {}, 'embedding_properties': {}}, '... (1 items)']}, 'pruning_stats': {'pruned_nodes': [], 'pruned_relationships': [], 'pruned_properties': []}}, 'timestamp': datetime.datetime(2026, 2, 25, 4, 13, 30, 117194, tzinfo=datetime.timezone.utc)}
DEBUG:neo4j_graphrag.experimental.pipeline.orchestrator:ORCHESTRATOR 302de781-ad0d-4f09-bfea-165982c135d9: enqueuing next task: writer
DEBUG:neo4j_graphrag.experimental.pipeline.pipeline:TASK START self.name='writer' input={'graph': {'nodes': [{'id': 'e2c5b257-adf4-49df-a684-f3e84dff21ed', 'label': 'Document', 'properties': {'path': 'document.txt', 'createdAt': '2026-02-25T04:13:26.872268+00:00', 'document_type': 'inline_text'}, 'embedding_properties': {}}, {'id': '3c02cebf-e283-4276-b4d3-5679619eb4c8', 'label': 'Chunk', 'properties': {'text': 'The son of Duke Leto Atreides and the Lady Jessica, Paul is the heir of House Atreides,\nan aristocratic family that rules the planet Caladan, the rainy planet, since 10191.', 'index': 0}, 'embedding_properties': {'embedding': [0.005049355793744326, -0.005022849887609482, -0.024464856833219528, -0.023815464228391647, -0.008548121899366379, '... (1531 items)']}}, {'id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:0', 'label': 'Person', 'properties': {'name': 'Paul'}, 'embedding_properties': {}}, {'id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:1', 'label': 'House', 'properties': {'name': 'House Atreides'}, 'embedding_properties': {}}, {'id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:2', 'label': 'Planet', 'properties': {'weather': 'rainy'}, 'embedding_properties': {}}], 'relationships': [{'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8', 'end_node_id': 'e2c5b257-adf4-49df-a684-f3e84dff21ed', 'type': 'FROM_DOCUMENT', 'properties': {}, 'embedding_properties': {}}, {'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:0', 'end_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:1', 'type': 'HEIR_OF', 'properties': {}, 'embedding_properties': {}}, {'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:1', 'end_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:2', 'type': 'RULES', 'properties': {'fromYear': 10191}, 'embedding_properties': {}}, {'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:0', 'end_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8', 'type': 'FROM_CHUNK', 'properties': {}, 'embedding_properties': {}}, {'start_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8:1', 'end_node_id': '3c02cebf-e283-4276-b4d3-5679619eb4c8', 'type': 'FROM_CHUNK', 'properties': {}, 'embedding_properties': {}}, '... (1 items)']}}
ERROR:neo4j_graphrag.experimental.components.kg_writer:{code: Neo.ClientError.Procedure.ProcedureNotFound} {message: There is no procedure with the name `apoc.create.addLabels` registered for this database instance. Please ensure you've spelled the procedure name correctly and that the procedure is properly deployed.}
Traceback (most recent call last):
  File "/Users/ash/Documents/repos/Zoomlytics/power-atlas/vendor/neo4j-graphrag-python/src/neo4j_graphrag/experimental/components/kg_writer.py", line 212, in run
    self._upsert_nodes(batch, lexical_graph_config)
  File "/Users/ash/Documents/repos/Zoomlytics/power-atlas/vendor/neo4j-graphrag-python/src/neo4j_graphrag/experimental/components/kg_writer.py", line 159, in _upsert_nodes
    self.driver.execute_query(
  File "/Users/ash/Documents/repos/Zoomlytics/power-atlas/.venv/lib/python3.11/site-packages/neo4j/_sync/driver.py", line 978, in execute_query
    return session._run_transaction(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ash/Documents/repos/Zoomlytics/power-atlas/.venv/lib/python3.11/site-packages/neo4j/_sync/work/session.py", line 588, in _run_transaction
    result = transaction_function(tx, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ash/Documents/repos/Zoomlytics/power-atlas/.venv/lib/python3.11/site-packages/neo4j/_sync/driver.py", line 1314, in _work
    res = tx.run(query, parameters)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ash/Documents/repos/Zoomlytics/power-atlas/.venv/lib/python3.11/site-packages/neo4j/_sync/work/transaction.py", line 206, in run
    result._tx_ready_run(query, parameters)
  File "/Users/ash/Documents/repos/Zoomlytics/power-atlas/.venv/lib/python3.11/site-packages/neo4j/_sync/work/result.py", line 177, in _tx_ready_run
    self._run(query, parameters, None, None, None, None, None, None)
  File "/Users/ash/Documents/repos/Zoomlytics/power-atlas/.venv/lib/python3.11/site-packages/neo4j/_sync/work/result.py", line 236, in _run
    self._attach()
  File "/Users/ash/Documents/repos/Zoomlytics/power-atlas/.venv/lib/python3.11/site-packages/neo4j/_sync/work/result.py", line 430, in _attach
    self._connection.fetch_message()
  File "/Users/ash/Documents/repos/Zoomlytics/power-atlas/.venv/lib/python3.11/site-packages/neo4j/_sync/io/_common.py", line 193, in inner
    func(*args, **kwargs)
  File "/Users/ash/Documents/repos/Zoomlytics/power-atlas/.venv/lib/python3.11/site-packages/neo4j/_sync/io/_bolt.py", line 863, in fetch_message
    res = self._process_message(tag, fields)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ash/Documents/repos/Zoomlytics/power-atlas/.venv/lib/python3.11/site-packages/neo4j/_sync/io/_bolt5.py", line 500, in _process_message
    response.on_failure(summary_metadata or {})
  File "/Users/ash/Documents/repos/Zoomlytics/power-atlas/.venv/lib/python3.11/site-packages/neo4j/_sync/io/_common.py", line 263, in on_failure
    raise self._hydrate_error(metadata)
neo4j.exceptions.ClientError: {code: Neo.ClientError.Procedure.ProcedureNotFound} {message: There is no procedure with the name `apoc.create.addLabels` registered for this database instance. Please ensure you've spelled the procedure name correctly and that the procedure is properly deployed.}
DEBUG:neo4j_graphrag.experimental.pipeline.pipeline:TASK FINISHED writer in 3.22s res={'status': <RunStatus.DONE: 'DONE'>, 'result': {'status': 'FAILURE', 'metadata': {'error': "{code: Neo.ClientError.Procedure.ProcedureNotFound} {message: There is no procedure with the name `apoc.create.addLabels` registered for this database instance. Please ensure you've spelled the proced... (64 chars)"}}, 'timestamp': datetime.datetime(2026, 2, 25, 4, 13, 33, 340996, tzinfo=datetime.timezone.utc)}
DEBUG:neo4j_graphrag.experimental.pipeline.orchestrator:ORCHESTRATOR 302de781-ad0d-4f09-bfea-165982c135d9: enqueuing next task: resolver
DEBUG:neo4j_graphrag.experimental.pipeline.pipeline:TASK START self.name='resolver' input={}
WARNING:neo4j.notifications:Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownLabelWarning} {category: UNRECOGNIZED} {title: The provided label is not in the database.} {description: One of the labels in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing label name is: __Entity__)} {position: line: 1, column: 15, offset: 14} for query: 'MATCH (entity:__Entity__)  RETURN count(entity) as c'
DEBUG:neo4j_graphrag.experimental.pipeline.pipeline:TASK FINISHED resolver in 0.37s res={'status': <RunStatus.DONE: 'DONE'>, 'result': {'number_of_nodes_to_resolve': 0, 'number_of_created_nodes': None}, 'timestamp': datetime.datetime(2026, 2, 25, 4, 13, 33, 715550, tzinfo=datetime.timezone.utc)}
DEBUG:neo4j_graphrag.experimental.pipeline.pipeline:PIPELINE FINISHED 302de781-ad0d-4f09-bfea-165982c135d9 in 8.31s
run_id='302de781-ad0d-4f09-bfea-165982c135d9' result={'resolver': {'number_of_nodes_to_resolve': 0, 'number_of_created_nodes': None}}